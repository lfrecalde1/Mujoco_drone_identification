%% Data Figure
%% Clear variables
clc, clear all, close all;

%% Load information
load("Data_identification.mat");

%% Split Velocity
ul = hp(1, :);
um = hp(2, :);
un = hp(3, :);
p = hp(4, :);
q = hp(5, :);
r = hp(6, :);

%% Split Forces and Torques
fx = F(1, :);
fy = F(2, :);
fz = F(3, :);

tx = T(1, :);
ty = T(2, :);
tz = T(3, :);

figure
set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [4 2]);
set(gcf, 'PaperPositionMode', 'manual');
set(gcf, 'PaperPosition', [0 0 10 4]);
subplot(4,1,1)
plot(t(1:length(ul_ref)),ul_ref,'Color',[226,76,44]/255,'linewidth',1); hold on
plot(t,ul(1,1:length(t)),'--','Color',[226,76,44]/255,'linewidth',1); hold on
grid on;
legend({'$\mu_{lc}$','$\mu_{l}$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
title('$\textrm{Identification signals and real Signals}$','Interpreter','latex','FontSize',9);
ylabel('$[m/s]$','Interpreter','latex','FontSize',9);

subplot(4,1,2)
plot(t(1:length(ul_ref)),um_ref,'Color',[46,188,89]/255,'linewidth',1); hold on
plot(t,um(1,1:length(t)),'--','Color',[46,188,89]/255,'linewidth',1); hold on
grid on;
legend({'$\mu_{mc}$','$\mu_{m}$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
ylabel('$[m/s]$','Interpreter','latex','FontSize',9);

subplot(4,1,3)
plot(t(1:length(ul_ref)),un_ref,'Color',[26,115,160]/255,'linewidth',1); hold on
plot(t,un(1:length(t)),'--','Color',[26,115,160]/255,'linewidth',1); hold on
grid on;
legend({'$\mu_{nc}$','$\mu_{n}$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
ylabel('$[m/s]$','Interpreter','latex','FontSize',9);

subplot(4,1,4)
plot(t(1:length(ul_ref)),w_ref,'Color',[83,57,217]/255,'linewidth',1); hold on
plot(t,r(1,1:length(t)),'--','Color',[83,57,217]/255,'linewidth',1); hold on
grid on;
legend({'$\omega_{c}$','$\omega$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
ylabel('$[rad/s]$','Interpreter','latex','FontSize',9);
xlabel('$\textrm{Time}[s]$','Interpreter','latex','FontSize',9);

figure
set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [4 2]);
set(gcf, 'PaperPositionMode', 'manual');
set(gcf, 'PaperPosition', [0 0 10 4]);
subplot(4,1,1)
plot(t,ty(1,1:length(t)),'-','Color',[226,76,44]/255,'linewidth',1); hold on
grid on;
legend({'$\tau_y$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
title('$\textrm{Identification signals and real Signals}$','Interpreter','latex','FontSize',9);
ylabel('$[Nm]$','Interpreter','latex','FontSize',9);

subplot(4,1,2)
plot(t,tx(1,1:length(t)),'-','Color',[46,188,89]/255,'linewidth',1); hold on
grid on;
legend({'$\tau_x$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
ylabel('$[Nm]$','Interpreter','latex','FontSize',9);

subplot(4,1,3)
plot(t,fz(1:length(t)),'-','Color',[26,115,160]/255,'linewidth',1); hold on
grid on;
legend({'$f_z$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
ylabel('$[N]$','Interpreter','latex','FontSize',9);

subplot(4,1,4)
plot(t,tz(1,1:length(t)),'-','Color',[83,57,217]/255,'linewidth',1); hold on
grid on;
legend({'$\tau_z$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
ylabel('$[Nm]$','Interpreter','latex','FontSize',9);
xlabel('$\textrm{Time}[s]$','Interpreter','latex','FontSize',9);

figure
set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [4 2]);
set(gcf, 'PaperPositionMode', 'manual');
set(gcf, 'PaperPosition', [0 0 10 4]);
subplot(4,1,1)
plot(t,q(1,1:length(t)),'-','Color',[226,76,44]/255,'linewidth',1); hold on
grid on;
legend({'$q$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
title('$\textrm{Identification signals and real Signals}$','Interpreter','latex','FontSize',9);
ylabel('$[Nm]$','Interpreter','latex','FontSize',9);

subplot(4,1,2)
plot(t,p(1,1:length(t)),'-','Color',[46,188,89]/255,'linewidth',1); hold on
grid on;
legend({'$p$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
ylabel('$[Nm]$','Interpreter','latex','FontSize',9);

subplot(4,1,3)
plot(t,un(1:length(t)),'-','Color',[26,115,160]/255,'linewidth',1); hold on
grid on;
legend({'$\mu_z$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
ylabel('$[N]$','Interpreter','latex','FontSize',9);

subplot(4,1,4)
plot(t,r(1,1:length(t)),'-','Color',[83,57,217]/255,'linewidth',1); hold on
grid on;
legend({'$r$'},'Interpreter','latex','FontSize',11,'Orientation','horizontal');
legend('boxoff')
ylabel('$[Nm]$','Interpreter','latex','FontSize',9);
xlabel('$\textrm{Time}[s]$','Interpreter','latex','FontSize',9);